<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端知识库@阳树阳树🚀</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="logo.png">
    <meta name="description" content="前端er的面试必备知识——前端算法与前端面试题！">
    
    <link rel="preload" href="/learn-javas/assets/css/0.styles.d96df2b1.css" as="style"><link rel="preload" href="/learn-javas/assets/js/app.1d4069ff.js" as="script"><link rel="preload" href="/learn-javas/assets/js/3.ca18a2f9.js" as="script"><link rel="preload" href="/learn-javas/assets/js/1.5581c46e.js" as="script"><link rel="preload" href="/learn-javas/assets/js/23.fea367bc.js" as="script"><link rel="prefetch" href="/learn-javas/assets/js/10.de4f8882.js"><link rel="prefetch" href="/learn-javas/assets/js/11.72b51413.js"><link rel="prefetch" href="/learn-javas/assets/js/12.817ca176.js"><link rel="prefetch" href="/learn-javas/assets/js/13.68d71352.js"><link rel="prefetch" href="/learn-javas/assets/js/14.9352b13d.js"><link rel="prefetch" href="/learn-javas/assets/js/15.051ba7d5.js"><link rel="prefetch" href="/learn-javas/assets/js/16.396d210a.js"><link rel="prefetch" href="/learn-javas/assets/js/17.7a0c39b5.js"><link rel="prefetch" href="/learn-javas/assets/js/18.6660618b.js"><link rel="prefetch" href="/learn-javas/assets/js/19.bd78bcf3.js"><link rel="prefetch" href="/learn-javas/assets/js/20.3569980e.js"><link rel="prefetch" href="/learn-javas/assets/js/21.909d9c43.js"><link rel="prefetch" href="/learn-javas/assets/js/22.c9398446.js"><link rel="prefetch" href="/learn-javas/assets/js/24.e363ec71.js"><link rel="prefetch" href="/learn-javas/assets/js/25.d6d0ab40.js"><link rel="prefetch" href="/learn-javas/assets/js/26.2e627c9a.js"><link rel="prefetch" href="/learn-javas/assets/js/27.e4e28523.js"><link rel="prefetch" href="/learn-javas/assets/js/28.191e633d.js"><link rel="prefetch" href="/learn-javas/assets/js/29.b2b7e44b.js"><link rel="prefetch" href="/learn-javas/assets/js/30.185cd311.js"><link rel="prefetch" href="/learn-javas/assets/js/31.c8b24b23.js"><link rel="prefetch" href="/learn-javas/assets/js/32.236f4141.js"><link rel="prefetch" href="/learn-javas/assets/js/33.f429609d.js"><link rel="prefetch" href="/learn-javas/assets/js/34.0ba54e4e.js"><link rel="prefetch" href="/learn-javas/assets/js/35.c9f6c234.js"><link rel="prefetch" href="/learn-javas/assets/js/36.4afa9156.js"><link rel="prefetch" href="/learn-javas/assets/js/4.824112d7.js"><link rel="prefetch" href="/learn-javas/assets/js/5.9c8f2dee.js"><link rel="prefetch" href="/learn-javas/assets/js/6.ea663ed9.js"><link rel="prefetch" href="/learn-javas/assets/js/7.a41bed48.js"><link rel="prefetch" href="/learn-javas/assets/js/8.8fda9217.js"><link rel="prefetch" href="/learn-javas/assets/js/9.fd258643.js">
    <link rel="stylesheet" href="/learn-javas/assets/css/0.styles.d96df2b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-130b300a><div data-v-130b300a><div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-130b300a data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>前端知识库@阳树阳树🚀</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>前端er的面试必备知识——前端算法与前端面试题！</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-130b300a><header class="navbar" data-v-130b300a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-javas/" class="home-link router-link-active"><img src="/learn-javas/logo.png" alt="前端知识库@阳树阳树🚀" class="logo"> <span class="site-name">前端知识库@阳树阳树🚀</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/learn-javas/handbook/start.html" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><a href="/learn-javas/text/juzi.html" class="nav-link"><i class="undefined"></i>
  文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      more about @阳树阳树
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/18062706139fcz" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  myGithub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_60789461?type=blog" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  myCSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-130b300a></div> <aside class="sidebar" data-v-130b300a><div class="personal-info-wrapper" data-v-39576ba9 data-v-130b300a><!----> <!----> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>2</h3> <h6 data-v-39576ba9>Articles</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>0</h3> <h6 data-v-39576ba9>Tags</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/learn-javas/handbook/start.html" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><a href="/learn-javas/text/juzi.html" class="nav-link"><i class="undefined"></i>
  文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      more about @阳树阳树
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/18062706139fcz" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  myGithub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_60789461?type=blog" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  myCSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/learn-javas/handbook/start" class="sidebar-heading clickable"><span>Hey! This is 阳树!🎄</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/learn-javas/handbook/http" class="sidebar-heading clickable open active"><span>计算机网络⛄</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-javas/handbook/http.html" aria-current="page" class="active sidebar-link">HTTP专题</a></li><li><a href="/learn-javas/handbook/http.html" aria-current="page" class="active sidebar-link">其他网络协议相关</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/learn-javas/handbook/algorithm" class="sidebar-heading clickable"><span>算法与数据结构🐠</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/learn-javas/handbook/html" class="sidebar-heading clickable"><span>前端相关知识点✨</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/learn-javas/handbook/ie" class="sidebar-heading clickable"><span>浏览器🐧</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/learn-javas/handbook/CSAPP" class="sidebar-heading clickable"><span>CSAPP🌰</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/learn-javas/interview/questions" class="sidebar-heading clickable"><span>面经🎊</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/learn-javas/text/juzi" class="sidebar-heading clickable"><span>文章🌱</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2></h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <!---->
          2022
        </a></span></div></div> <div data-v-130b300a><main class="page"><section><div class="page-title"><h1 class="title"></h1> <div data-v-f875f3fc><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1>HTTP相关知识</h1> <hr> <h2 id="http知识点总结"><a href="#http知识点总结" class="header-anchor">#</a> HTTP知识点总结</h2> <h3 id="http的报文是什么样子的"><a href="#http的报文是什么样子的" class="header-anchor">#</a> HTTP的报文是什么样子的</h3> <p>HTTP 协议的请求报文和响应报文的结构基本相同<br>
由三大部分组成：
1.起始行（start line）：描述请求或响应的基本信息；<br>
2.头部字段集合（header）：使用 key-value 形式更详细地说明报文；<br>
3.消息正文（entity）：实际传输的数据，它不一定是纯文本，可以是图片、视频等二进制数据。<br></p> <blockquote><p>HTTP报文如图<br></p></blockquote> <p><img src="https://static001.geekbang.org/resource/image/62/3c/62e061618977565c22c2cf09930e1d3c.png" alt="image"></p> <h4 id="起始行"><a href="#起始行" class="header-anchor">#</a> 起始行</h4> <p>（1）请求方法：是一个动词，如 GET/POST，表示对资源的操作；<br>
（2）请求目标：通常是一个 URI，标记了请求方法要操作的资源；<br>
（3）版本号：表示报文使用的 HTTP 协议版本。<br></p> <p><img src="https://static001.geekbang.org/resource/image/36/b9/36108959084392065f36dff3e12967b9.png" alt="image"></p> <h4 id="状态行"><a href="#状态行" class="header-anchor">#</a> 状态行</h4> <p>（1）版本号：表示报文使用的 HTTP 协议版本；<br>
（2）状态码：一个三位数，用代码的形式表示处理的结果，比如 200 是成功，500 是服务器错误；<br>
（3）原因：作为数字状态码补充，是更详细的解释文字，帮助人理解原因。<br></p> <blockquote><p>头部字段请求报文和响应报文差不多</p></blockquote> <p><img src="https://static001.geekbang.org/resource/image/1f/ea/1fe4c1121c50abcf571cebd677a8bdea.png" alt="image"><br></p> <p><img src="https://static001.geekbang.org/resource/image/cb/75/cb0d1d2c56400fe9c9988ee32842b175.png" alt="image"></p> <h3 id="常用头字段"><a href="#常用头字段" class="header-anchor">#</a> 常用头字段</h3> <h4 id="四大头字段"><a href="#四大头字段" class="header-anchor">#</a> 四大头字段</h4> <p>（1）通用字段：在请求头和响应头里都可以出现；<br>
（2）请求字段：仅能出现在请求头里，进一步说明请求信息或者额外的附加条件；<br>
（3）响应字段：仅能出现在响应头里，补充说明响应报文的信息；<br>
（4）实体字段：它实际上属于通用字段，但专门描述 body 的额外信息。<br></p> <h4 id="使用头字段的注意点"><a href="#使用头字段的注意点" class="header-anchor">#</a> 使用头字段的注意点：</h4> <p>1.字段名不区分大小写，例如“Host”也可以写成“host”，但首字母大写的可读性更好；<br>
2.字段名里不允许出现空格，可以使用连字符“-”，但不能使用下划线“_”。例如，“test-name”是合法的字段名，而“test name”“test_name”是不正确的字段名；<br>
3.字段名后面必须紧接着“:”，不能有空格，而“:”后的字段值前可以有多个空格；<br>
4.字段的顺序是没有意义的，可以任意排列不影响语义；<br>
5.字段原则上不能重复，除非这个字段本身的语义允许，例如 Set-Cookie。<br></p> <h4 id="http报文结构总结"><a href="#http报文结构总结" class="header-anchor">#</a> HTTP报文结构总结</h4> <p>1.HTTP 报文结构就像是“大头儿子”，由“起始行 + 头部 + 空行 + 实体”组成，简单地说就是“header+body”；<br>
2.HTTP 报文可以没有 body，但必须要有 header，而且 header 后也必须要有空行，形象地说就是“大头”必须要带着“脖子”；<br>
3.请求头由“请求行 + 头部字段”构成，响应头由“状态行 + 头部字段”构成；请求行有三部分：请求方法，请求目标和版本号；<br>
4.状态行也有三部分：版本号，状态码和原因字符串；头部字段是 key-value 的形式，用“:”分隔，不区分大小写，顺序任意，除了规定的标准头，也可以任意添加自定义字段，实现功能扩展；<br>
5.HTTP/1.1 里唯一要求必须提供的头字段是 Host，它必须出现在请求头里，标记虚拟主机名。<br></p> <h3 id="应该如何理解请求方法"><a href="#应该如何理解请求方法" class="header-anchor">#</a> 应该如何理解请求方法</h3> <blockquote><p>请求头里的请求方法</p></blockquote> <h4 id="请求方法-客户端发出了一个-动作指令-要求服务器端对-uri-定位的资源执行这个动作。"><a href="#请求方法-客户端发出了一个-动作指令-要求服务器端对-uri-定位的资源执行这个动作。" class="header-anchor">#</a> 请求方法：客户端发出了一个“动作指令”，要求服务器端对 URI 定位的资源执行这个动作。</h4> <h4 id="八种常见方法-单词都必须是大写的形式"><a href="#八种常见方法-单词都必须是大写的形式" class="header-anchor">#</a> 八种常见方法，单词都必须是大写的形式</h4> <p>1.GET:获取资源，可以理解为读取或者下载数据<br>
2.HEAD:获取资源的元信息；<br></p> <blockquote><p>HEAD 方法与 GET 方法类似，也是请求从服务器获取资源，服务器的处理机制也是一样的，但服务器不会返回请求的实体数据，只会传回响应头，也就是资源的“元信息”。<br></p></blockquote> <p>3.POST：向资源提交数据，相当于写入或上传数据；<br>
4.PUT：类似 POST；<br>
5.DELETE：删除资源；<br>
6.CONNECT：建立特殊的连接隧道；<br>
7.OPTIONS：列出可对资源实行的方法；<br>
8.TRACE：追踪请求 - 响应的传输路径。<br></p> <p><img src="https://static001.geekbang.org/resource/image/3c/6d/3cdc8ac71b80929f4a94dfeb9ffe4b6d.jpg" alt="image"></p> <h4 id="安全与幂等"><a href="#安全与幂等" class="header-anchor">#</a> 安全与幂等</h4> <p>1.安全：请求方法不会“破坏”服务器上的资源，即不会对服务器上的资源造成实质的修改。<br>
2.“幂等”实际上是一个数学用语，被借用到了 HTTP 协议里，意思是多次执行相同的操作，结果也都是相同的，即多次“幂”后结果“相等”。<br>
GET和HEAD是安全的，因为只读取取不修改，GET和HEAD也是幂等的，因为多次执行GET和HEAD操作后，结果是相同的<br>
POST/PUT/DELETE都是不安全的<br>
POST 和 PUT 的幂等性质：<br>
POST 是“新增或提交数据”，多次提交数据会创建多个资源，所以不是幂等的；而 PUT 是“替换或更新数据”，多次更新一个资源，资源还是会第一次更新的状态，所以是幂等的。<br></p> <h4 id="请求方法小结"><a href="#请求方法小结" class="header-anchor">#</a> 请求方法小结：</h4> <p>请求方法是客户端发出的、要求服务器执行的、对资源的一种操作；<br>
请求方法是对服务器的“指示”，真正应如何处理由服务器来决定；<br>
最常用的请求方法是 GET 和 POST，分别是获取数据和发送数据；<br>
HEAD 方法是轻量级的 GET，用来获取资源的元信息；<br>
PUT 基本上是 POST 的同义词，多用于更新数据；<br>
“安全”与“幂等”是描述请求方法的两个重要属性，具有理论指导意义，可以帮助我们设计系统。<br></p> <h3 id="uri相关知识"><a href="#uri相关知识" class="header-anchor">#</a> URI相关知识</h3> <p>1.URI 是用来唯一标记服务器上资源的一个字符串，通常也称为 URL；<br>
2.URI 通常由 scheme、host:port、path 和 query 四个部分组成，有的可以省略；<br>
3.scheme 叫“方案名”或者“协议名”，表示资源应该使用哪种协议来访问；<br>
4.“host:port”表示资源所在的主机名和端口号；path 标记资源所在的位置；<br>
5.query 表示对资源附加的额外要求；<br>
6.在 URI 里对“@&amp;/”等特殊字符和汉字必须要做编码，否则服务器收到 HTTP 报文后会无法正确处理。<br></p> <h3 id="状态码相关知识"><a href="#状态码相关知识" class="header-anchor">#</a> 状态码相关知识</h3> <p>1.状态码在响应报文里表示了服务器对请求的处理结果；<br>
2.状态码后的原因短语是简单的文字描述，可以自定义；<br>
3.状态码是十进制的三位数，分为五类，从 100 到 599；<br>
4.2××类状态码表示成功，常用的有 200、204、206；<br>
5.3××类状态码表示重定向，常用的有 301、302、304；<br>
6.4××类状态码表示客户端错误，常用的有 400、403、404；<br>
7.5××类状态码表示服务器错误，常用的有 500、501、502、503。<br></p> <h3 id="http有哪些特点"><a href="#http有哪些特点" class="header-anchor">#</a> HTTP有哪些特点</h3> <p>1.HTTP 是灵活可扩展的，可以任意添加头字段实现任意功能；<br>
2.HTTP 是可靠传输协议，基于 TCP/IP 协议“尽量”保证数据的送达；<br>
3.HTTP 是应用层协议，比 FTP、SSH 等更通用功能更多，能够传输任意数据；<br>
4.HTTP 使用了请求 - 应答模式，客户端主动发起请求，服务器被动回复请求；<br>
5.HTTP 本质上是无状态的，每个请求都是互相独立、毫无关联的，协议不要求客户端或服务器记录请求相关的信息。<br></p> <h3 id="http的优点与缺点"><a href="#http的优点与缺点" class="header-anchor">#</a> HTTP的优点与缺点</h3> <p>1.HTTP 最大的优点是简单、灵活和易于扩展；<br>
2.HTTP 拥有成熟的软硬件环境，应用的非常广泛，是互联网的基础设施；<br></p> <div class="language- extra-class"><pre class="language-text"><code>它并不限定某种编程语言或者操作系统，所以天然具有“跨语言、跨平台”的优越性。
</code></pre></div><p>3.HTTP 是无状态的，可以轻松实现集群化，扩展性能，但有时也需要用 Cookie 技术来实现“有状态”；<br></p> <div class="language- extra-class"><pre class="language-text"><code>因为服务器没有“记忆能力”，所以就不需要额外的资源来记录状态信息，
不仅实现上会简单一些，而且还能减轻服务器的负担，能够把更多的 CPU 和内存用来对外提供服务。
而且，“无状态”也表示服务器都是相同的，没有“状态”的差异，所以可以很容易地组成集群，让负载均衡把请求转发到任意一台服务器，
不会因为状态不一致导致处理出错，使用“堆机器”的“笨办法”轻松实现高并发高可用。
</code></pre></div><p>4.HTTP 是明文传输，数据完全肉眼可见，能够方便地研究分析，但也容易被窃听；<br>
5.HTTP 是不安全的，无法验证通信双方的身份，也不能判断报文是否被篡改；<br></p> <div class="language- extra-class"><pre class="language-text"><code>HTTP不安全的三个方面：
(1)数据被窃听
(2)身份被冒用
(3)数据被篡改
</code></pre></div><p>6.HTTP 的性能不算差，但不完全适应现在的互联网，还有很大的提升空间。<br></p> <h3 id="http的实体数据「body」"><a href="#http的实体数据「body」" class="header-anchor">#</a> HTTP的实体数据「body」</h3> <h4 id="_1-http如何确定文件格式"><a href="#_1-http如何确定文件格式" class="header-anchor">#</a> (1)HTTP如何确定文件格式？</h4> <p>“多用途互联网邮件扩展”（Multipurpose Internet Mail Extensions），简称为 MIME。MIME通常用在电子邮件系统中，让电子邮件可以发送 ASCII 码以外的任意数据。<br>
MIME 是一个很大的标准规范，但 HTTP 只“顺手牵羊”取了其中的一部分，用来标记 body 的数据类型，这就是我们平常总能听到的“MIME type”。</p> <h4 id="mime-type"><a href="#mime-type" class="header-anchor">#</a> MIME type</h4> <p>1.text：即文本格式的可读数据，我们最熟悉的应该就是 text/html 了，表示超文本文档，此外还有纯文本 text/plain、样式表 text/css 等。<br>
2.image：即图像文件，有 image/gif、image/jpeg、image/png 等。<br>
3.audio/video：音频和视频数据，例如 audio/mpeg、video/mp4 等。<br>
4.application：数据格式不固定，可能是文本也可能是二进制，必须由上层应用程序来解释。常见的有 application/json，application/javascript、application/pdf 等，另外，如果实在是不知道数据是什么类型，像刚才说的“黑盒”，就会是 application/octet-stream，即不透明的二进制数据。</p> <h4 id="encoding-type-告诉数据是用的什么编码格式"><a href="#encoding-type-告诉数据是用的什么编码格式" class="header-anchor">#</a> Encoding type:告诉数据是用的什么编码格式</h4> <p>1.gzip：GNU zip 压缩格式，也是互联网上最流行的压缩格式；<br>
2.deflate：zlib（deflate）压缩格式，流行程度仅次于 gzip；<br>
br：一种专门为 HTTP 优化的新压缩算法（Brotli）。<br></p> <h4 id="与mime-type相关的头字段是-accept-和-content-type"><a href="#与mime-type相关的头字段是-accept-和-content-type" class="header-anchor">#</a> 与MIME type相关的头字段是 Accept 和 Content-Type；</h4> <p>Accept 字段标记的是客户端可理解的 MIME type，可以用“,”做分隔符列出多个类型，让服务器有更多的选择余地，例如下面的这个头：</p> <div class="language- extra-class"><pre class="language-text"><code>Accept: text/html,application/xml,image/webp,image/png
</code></pre></div><p>服务器则会在响应报文里用头字段 Content-Type 告诉实体数据的真实类型：</p> <div class="language-js extra-class"><pre class="language-js"><code>Content<span class="token operator">-</span>Type<span class="token operator">:</span> text<span class="token operator">/</span>html
Content<span class="token operator">-</span>Type<span class="token operator">:</span> image<span class="token operator">/</span>png
</code></pre></div><p><img src="https://static001.geekbang.org/resource/image/51/b9/5191bce1329efa157a6cc37ab9e789b9.png" alt="image"></p> <h4 id="_2-数据编码表示实体数据的压缩方式-相关的头字段是-accept-encoding-和-content-encoding"><a href="#_2-数据编码表示实体数据的压缩方式-相关的头字段是-accept-encoding-和-content-encoding" class="header-anchor">#</a> (2)数据编码表示实体数据的压缩方式，相关的头字段是 Accept-Encoding 和 Content-Encoding；</h4> <p>例子：<br></p> <div class="language-js extra-class"><pre class="language-js"><code>Accept<span class="token operator">-</span>Encoding<span class="token operator">:</span> gzip<span class="token punctuation">,</span> deflate<span class="token punctuation">,</span> br
Content<span class="token operator">-</span>Encoding<span class="token operator">:</span> gzip
</code></pre></div><h4 id="_3-语言类型表示实体数据的自然语言-相关的头字段是-accept-language-和-content-language"><a href="#_3-语言类型表示实体数据的自然语言-相关的头字段是-accept-language-和-content-language" class="header-anchor">#</a> (3)语言类型表示实体数据的自然语言，相关的头字段是 Accept-Language 和 Content-Language；</h4> <div class="language-js extra-class"><pre class="language-js"><code>Accept<span class="token operator">-</span>Language<span class="token operator">:</span> zh<span class="token operator">-</span><span class="token constant">CN</span><span class="token punctuation">,</span> zh<span class="token punctuation">,</span> en
Content<span class="token operator">-</span>Language<span class="token operator">:</span> zh<span class="token operator">-</span><span class="token constant">CN</span>
</code></pre></div><h4 id="_4-字符集表示实体数据的编码方式-相关的头字段是-accept-charset-和-content-type"><a href="#_4-字符集表示实体数据的编码方式-相关的头字段是-accept-charset-和-content-type" class="header-anchor">#</a> （4）字符集表示实体数据的编码方式，相关的头字段是 Accept-Charset 和 Content-Type；</h4> <div class="language-js extra-class"><pre class="language-js"><code>Accept<span class="token operator">-</span>Charset<span class="token operator">:</span> gbk<span class="token punctuation">,</span> utf<span class="token operator">-</span><span class="token number">8</span>
Content<span class="token operator">-</span>Type<span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">;</span> charset<span class="token operator">=</span>utf<span class="token operator">-</span><span class="token number">8</span>
</code></pre></div><h4 id="客户端需要在请求头里使用-accept-等头字段与服务器进行-内容协商-要求服务器返回最合适的数据"><a href="#客户端需要在请求头里使用-accept-等头字段与服务器进行-内容协商-要求服务器返回最合适的数据" class="header-anchor">#</a> 客户端需要在请求头里使用 Accept 等头字段与服务器进行“内容协商”，要求服务器返回最合适的数据；</h4> <h4 id="accept-等头字段可以用-顺序列出多个可能的选项-还可以用-q-参数来精确指定权重。"><a href="#accept-等头字段可以用-顺序列出多个可能的选项-还可以用-q-参数来精确指定权重。" class="header-anchor">#</a> Accept 等头字段可以用“,”顺序列出多个可能的选项，还可以用“;q=”参数来精确指定权重。</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8
</span></code></pre></div><h4 id="内容协商的结果"><a href="#内容协商的结果" class="header-anchor">#</a> 内容协商的结果</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">Vary</span><span class="token operator">:</span> Accept<span class="token operator">-</span>Encoding<span class="token punctuation">,</span>User<span class="token operator">-</span>Agent<span class="token punctuation">,</span>Accept
</code></pre></div><p>这个 Vary 字段表示服务器依据了 Accept-Encoding、User-Agent 和 Accept 这三个头字段，然后决定了发回的响应报文。</p> <p><img src="https://static001.geekbang.org/resource/image/b2/58/b2118315a977969ddfcc7ab9d26cb358.png" alt="image"></p> <h3 id="http的大文件传输方法"><a href="#http的大文件传输方法" class="header-anchor">#</a> HTTP的大文件传输方法</h3> <h4 id="_1-压缩-html-等文本文件是传输大文件最基本的方法"><a href="#_1-压缩-html-等文本文件是传输大文件最基本的方法" class="header-anchor">#</a> (1)压缩 HTML 等文本文件是传输大文件最基本的方法；</h4> <p>用了上次提到的Accept-Encoding头字段与Content-Encoding响应头，常见格式有gzip，deflate，br；</p> <h4 id="_2-分块传输可以流式收发数据-节约内存和带宽-使用响应头字段-transfer-encoding-chunked-来表示-分块的格式是-16-进制长度头-数据块"><a href="#_2-分块传输可以流式收发数据-节约内存和带宽-使用响应头字段-transfer-encoding-chunked-来表示-分块的格式是-16-进制长度头-数据块" class="header-anchor">#</a> (2)分块传输可以流式收发数据，节约内存和带宽，使用响应头字段“Transfer-Encoding: chunked”来表示，分块的格式是 16 进制长度头 + 数据块；</h4> <p>注意：<br>
1.“Transfer-Encoding: chunked”和“Content-Length”这两个字段是互斥的，也就是说响应报文里这两个字段不能同时出现，一个响应报文的传输要么是长度已知，要么是长度未知（chunked）<br>
2.分块传输的编码规则「采用明文」<br></p> <blockquote><p><strong>1.每个分块包含两个部分，长度头和数据块；</strong><br> <strong>2.长度头是以 CRLF（回车换行，即\r\n）结尾的一行明文，用 16 进制数字表示长度；</strong><br> <strong>3.数据块紧跟在长度头后，最后也用 CRLF 结尾，但数据不包含 CRLF；</strong><br> <strong>4.最后用一个长度为 0 的块表示结束，即“0\r\n\r\n”。</strong><br></p></blockquote> <p><img src="https://static001.geekbang.org/resource/image/25/10/25e7b09cf8cb4eaebba42b4598192410.png" alt="image"></p> <h4 id="_3-范围请求可以只获取部分数据-即-分块请求-实现视频拖拽或者断点续传-使用请求头字段-range-和响应头字段-content-range-响应状态码必须是-206"><a href="#_3-范围请求可以只获取部分数据-即-分块请求-实现视频拖拽或者断点续传-使用请求头字段-range-和响应头字段-content-range-响应状态码必须是-206" class="header-anchor">#</a> (3)范围请求可以只获取部分数据，即“分块请求”，实现视频拖拽或者断点续传，使用请求头字段“Range”和响应头字段“Content-Range”，响应状态码必须是 206；</h4> <p>1.Accept-Ranges:bytes 表名服务器支持范围请求<br>
2.范围请求，可以只播放某一段<br>
3.Range的格式<br></p> <blockquote><p><strong>“0-”表示从文档起点到文档终点，相当于“0-99”，即整个文件；</strong><br> <strong>“10-”是从第 10 个字节开始到文档末尾，相当于“10-99”；</strong><br> <strong>“-1”是文档的最后一个字节，相当于“99-99”；</strong><br> <strong>“-10”是从文档末尾倒数 10 个字节，相当于“90-99”。</strong><br></p></blockquote> <h4 id="_4-可以一次请求多个范围-这时候响应报文的数据类型是-multipart-byteranges-body-里的多个部分会用-boundary-字符串分隔。"><a href="#_4-可以一次请求多个范围-这时候响应报文的数据类型是-multipart-byteranges-body-里的多个部分会用-boundary-字符串分隔。" class="header-anchor">#</a> (4)可以一次请求多个范围，这时候响应报文的数据类型是“multipart/byteranges”，body 里的多个部分会用 boundary 字符串分隔。</h4> <p><img src="https://static001.geekbang.org/resource/image/ff/37/fffa3a65e367c496428f3c0c4dac8a37.png" alt="image"></p> <p>范围请求请求代码：</p> <details class="custom-block details"><summary>点击查看代码</summary> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">GET</span> <span class="token operator">/</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span> <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
<span class="token literal-property property">Host</span><span class="token operator">:</span> www<span class="token punctuation">.</span>chrono<span class="token punctuation">.</span>com
<span class="token literal-property property">Range</span><span class="token operator">:</span> bytes<span class="token operator">=</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token operator">-</span><span class="token number">29</span>
</code></pre></div></details> <p>范围请求响应代码：</p> <details class="custom-block details"><summary>点击查看代码</summary> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">206</span> Partial Content
<span class="token comment">// boundary代表分隔在下面有所体现</span>
Content<span class="token operator">-</span>Type<span class="token operator">:</span> multipart<span class="token operator">/</span>byteranges<span class="token punctuation">;</span> boundary<span class="token operator">=</span><span class="token number">00000000001</span>
Content<span class="token operator">-</span>Length<span class="token operator">:</span> <span class="token number">189</span>
<span class="token literal-property property">Connection</span><span class="token operator">:</span> keep<span class="token operator">-</span>alive
Accept<span class="token operator">-</span>Ranges<span class="token operator">:</span> bytes


<span class="token operator">--</span><span class="token number">00000000001</span>
Content<span class="token operator">-</span>Type<span class="token operator">:</span> text<span class="token operator">/</span>plain
Content<span class="token operator">-</span>Range<span class="token operator">:</span> bytes <span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">96</span>

<span class="token comment">// this is</span>
<span class="token operator">--</span><span class="token number">00000000001</span>
Content<span class="token operator">-</span>Type<span class="token operator">:</span> text<span class="token operator">/</span>plain
Content<span class="token operator">-</span>Range<span class="token operator">:</span> bytes <span class="token number">20</span><span class="token operator">-</span><span class="token number">29</span><span class="token operator">/</span><span class="token number">96</span>

ext json d
<span class="token operator">--</span><span class="token number">00000000001</span><span class="token operator">--</span>
</code></pre></div></details> <h3 id="http的连接管理"><a href="#http的连接管理" class="header-anchor">#</a> HTTP的连接管理</h3> <h4 id="短连接"><a href="#短连接" class="header-anchor">#</a> 短连接</h4> <p>(1)是什么？<br></p> <blockquote><p>因为客户端与服务器的整个连接过程很短暂，不会与服务器保持长时间的连接状态，所以就被称为“短连接”（short-lived connections）
(2)有什么缺点？<br>
每次进行请求-应答时，都需要TCP“三次握手”建立连接，四次挥手断开链接，传输效率低的吓人。<br>
ps:定义往返时间(round trip time，简称RTT)<br></p></blockquote> <p>(3)怎么解决？<br></p> <blockquote><p>建立长连接。<br>
用的是“成本均摊”的思路，既然 TCP 的连接和关闭非常耗时间，那么就把这个时间成本由原来的一个“请求 - 应答”均摊到多个“请求 - 应答”上。<br>
短连接与长连接的对比图<br> <img src="https://static001.geekbang.org/resource/image/57/b4/57b3d80234a1f1b8c538a376aa01d3b4.png" alt="image"></p></blockquote> <h4 id="长连接"><a href="#长连接" class="header-anchor">#</a> 长连接</h4> <p>(1)是什么？<br></p> <blockquote><p>针对短连接暴露出的缺点，HTTP 协议就提出了“长连接”的通信方式，也叫“持久连接”（persistent connections）、“连接保活”（keep alive）、“连接复用”（connection reuse）。<br></p></blockquote> <p>(2)有什么缺点？<br></p> <blockquote><p>如果TCP 连接长时间不关闭，服务器必须在内存里保存它的状态，这就占用了服务器的资源。如果有大量的空闲长连接只连不发，就会很快耗尽服务器的资源，导致服务器无法为真正有需要的用户提供服务。<br></p></blockquote> <p>(3)怎么解决？<br></p> <blockquote><p>在客户端，可以在请求头里加上“Connection: close”字段，告诉服务器：“这次通信后就关闭连接”。<br></p></blockquote> <p>(4)Nginx中的例子<br></p> <blockquote><p>服务器端通常不会主动关闭连接，但也可以使用一些策略。<br>
拿 Nginx 来举例，它有两种方式：<br>
1.使用“keepalive_timeout”指令，设置长连接的超时时间，如果在一段时间内连接上没有任何数据收发就主动断开连接，避免空闲连接占用系统资源。<br>
2.使用“keepalive_requests”指令，设置长连接上可发送的最大请求次数。比如设置成 1000，那么当 Nginx 在这个连接上处理了 1000 个请求后，也会主动断开连接。<br></p></blockquote> <h4 id="队头阻塞"><a href="#队头阻塞" class="header-anchor">#</a> 队头阻塞</h4> <p>(1)是什么？
由 HTTP 基本的“请求 - 应答”模型所导致的。<br>
因为 HTTP 规定报文必须是“一发一收”，这就形成了一个先进先出的“串行”队列。队列里的请求没有轻重缓急的优先级，只有入队的先后顺序，排在最前面的请求被最优先处理。<br>
所以如果队首处理的太慢了，后面的资源都无法处理<br></p> <p>(2)怎么解决？
1.“并发连接”（concurrent connections），也就是同时对一个域名发起多个长连接，用数量来解决质量的问题。<br>
但这种方式也存在缺陷。如果每个客户端都想自己快，建立很多个连接，用户数×并发数就会是个天文数字。服务器的资源根本就扛不住，或者被服务器认为是恶意攻击，反而会造成“拒绝服务”。<br>
2.“域名分片”（domain sharding）技术，还是用数量来解决质量的思路。<br>
HTTP 协议和浏览器不是限制并发连接数量吗？好，那我就多开几个域名。<br></p> <h3 id="http中的重定向"><a href="#http中的重定向" class="header-anchor">#</a> HTTP中的重定向</h3> <p>1.重定向是服务器发起的跳转，要求客户端改用新的 URI 重新发送请求，通常会自动进行，用户是无感知的；<br>
2.301/302 是最常用的重定向状态码，分别是“永久重定向”和“临时重定向”；<br>
3.响应头字段 Location 指示了要跳转的 URI，可以用绝对或相对的形式；<br>
4.重定向可以把一个 URI 指向另一个 URI「比如此网站短期维护」，也可以把多个 URI 指向同一个 URI「比如多个淘宝分站指向主站」，用途很多；<br>
5.使用重定向时需要当心性能损耗，还要避免出现循环跳转。<br></p> <h3 id="http中的cookie机制"><a href="#http中的cookie机制" class="header-anchor">#</a> HTTP中的Cookie机制</h3> <p>前言：HTTP 是“无状态”的，这既是优点也是缺点。优点是服务器没有状态差异，可以很容易地组成集群，而缺点就是无法支持需要记录状态的事务操作。<br></p> <h4 id="什么是cookie"><a href="#什么是cookie" class="header-anchor">#</a> 什么是Cookie</h4> <p>答：储存在用户本地终端上的数据<br></p> <h4 id="cookie的工作过程"><a href="#cookie的工作过程" class="header-anchor">#</a> Cookie的工作过程</h4> <p>Cookie工作流程，需要用到响应头字段：<br>
&quot;Set-Cookie&quot;和请求头字段&quot;Cookie&quot;<br>
1、客户端第一次请求时，没有cookie信息，服务器收到后响应报文里返回cookie信息。在头字段Set-Cookie中以key-value键值对存储<br>
2、客户端收到响应后，若Set-Cookie字段不为空，则将Cookie信息存在本地（一般是浏览器中），下一次请求时会将存储的Cookie信息放到头字段Cookie中发送给服务器，多个键值对中间用“;”隔开<br>
3、服务器再一次收到请求后，通过Cookie字段就能识别出该次请求的身份信息<br></p> <p>工作过程：<br></p> <p><img src="https://static001.geekbang.org/resource/image/9f/a4/9f6cca61802d65d063e24aa9ca7c38a4.png" alt="image"></p> <p>注意：<br> <strong>Cookie是浏览器内部绑定的</strong></p> <h4 id="cookie的属性"><a href="#cookie的属性" class="header-anchor">#</a> Cookie的属性</h4> <p><strong>设置 Cookie 的生存周期(有效期)</strong>
有两个属性<br>
1.“Expires”俗称“过期时间”，用的是绝对时间点，可以理解为“截止日期”（deadline）。<br>
2.“Max-Age”用的是相对时间，单位是秒，浏览器用收到报文的时间点再加上 Max-Age，就可以得到失效的绝对时间。<br>
3.两个都有的时候一般以Max-Age为标准<br> <strong>设置 Cookie 的作用域</strong>
有两个属性：<br>
1.“Domain”指定了 Cookie 所属的域名<br>
2.&quot;Path&quot;指定了 Cookie 所属的路径，一般不限制Path，直接用一个‘/’比较省事<br> <strong>Cookie 的安全性</strong>
属性“HttpOnly”会告诉浏览器，此 Cookie 只能通过浏览器 HTTP 协议传输，禁止其他方式访问。<br>
这样就防止了JS脚本读取Cookie。<br></p> <h4 id="http的缓存控制"><a href="#http的缓存控制" class="header-anchor">#</a> HTTP的缓存控制</h4> <p><strong>服务器的缓存控制</strong><br>
pre:缓存是优化系统性能的重要手段，HTTP 传输的每一个环节中都可以有缓存；<br></p> <p>缓存流程：<br>
1.浏览器发现缓存无数据，于是发送请求，向服务器获取资源；<br>
2.服务器响应请求，返回资源，同时标记资源的有效期；<br>
3.浏览器缓存资源，等待下次重用。<br></p> <p><img src="https://static001.geekbang.org/resource/image/a1/5b/a1968821f214df4a3ae16c9b30f99a5b.png" alt="image"></p> <p>看到图中的max-age了吗？<br>
它表示资源的有效期。<br>
它之所以存在，是因为服务器的资源会不断的更新，所以我不会一直保留着这个资源<br></p> <p>响应报文的其他属性：<br>
1.no-store：不允许缓存，用于某些变化非常频繁的数据，例如秒杀页面；<br>
2.no-cache「找最新的」：它的字面含义容易与 no-store 搞混，实际的意思并不是不允许缓存，而是可以缓存，但在使用之前必须要去服务器验证是否过期，是否有最新的版本；<br>
3.must-revalidate「看过期没」：又是一个和 no-cache 相似的词，它的意思是如果缓存不过期就可以继续使用，但过期了如果还想用就必须去服务器验证。<br></p> <p>用法流程图<br></p> <p><img src="https://static001.geekbang.org/resource/image/1b/99/1b4f48bc0d8fb9a08b45d1f0deac8a99.png" alt="image"></p> <p><strong>条件请求</strong><br>
1.验证资源是否失效需要使用“条件请求”，常用的是“if-Modified-Since”和“If-None-Match”，收到 304 就可以复用缓存里的资源；<br>
2.验证资源是否被修改的条件有两个：“Last-modified”和“ETag”，需要服务器预先在响应报文里设置，搭配条件请求使用；<br>
(1)ETag 是“实体标签”（Entity Tag）的缩写，是资源的一个唯一标识，主要是用来解决修改时间无法准确区分文件变化的问题。<br>
(2)ETag有强有弱：<br>
弱 ETag 在值前有个“W/”,标记仅需要在语义上没有变化即可但内部可能会有部分发生了改变（例如 HTML 里的标签顺序调整，或者多了几个空格）。<br>
强 ETag 要求资源在字节级别必须完全相符.<br></p> <h3 id="http的代理服务"><a href="#http的代理服务" class="header-anchor">#</a> HTTP的代理服务</h3> <h4 id="代理是什么"><a href="#代理是什么" class="header-anchor">#</a> 代理是什么？</h4> <p><strong>HTTP 代理就是客户端和服务器通信链路中的一个中间环节，为两端提供“代理服务”；</strong></p> <h4 id="代理的作用"><a href="#代理的作用" class="header-anchor">#</a> 代理的作用</h4> <p>1.负载均衡：<br>
当一台服务器的性能达到极限时，我们可以使用服务器集群来提高网站的整体性能。那么，在服务器集群中，需要有一台服务器充当调度者的角色，用户的所有请求都会首先由它接收，调度者再根据每台服务器的负载情况将请求分配给某一台后端服务器去处理。<br>
那么在这个过程中，调度者如何合理分配任务，保证所有后端服务器都将性能充分发挥，从而保持服务器集群的整体性能最优，这就是负载均衡问题。<br>
2.健康检查：使用“心跳”等机制监控后端服务器，发现有故障就及时“踢出”集群，保证服务高可用；<br>
3.安全防护：保护被代理的后端服务器，限制 IP 地址或流量，抵御网络攻击和过载；<br>
4.加密卸载：对外网使用 SSL/TLS 加密通信认证，而在安全的内网不加密，消除加解密成本；<br>
5.数据过滤：拦截上下行的数据，任意指定策略修改请求或者响应；<br></p> <h4 id="代理相关字段"><a href="#代理相关字段" class="header-anchor">#</a> 代理相关字段</h4> <p><strong>代理服务器需要使用字段“Via”标记自己的身份，多个代理会形成一个列表；</strong><br></p> <p>1.Via 字段解决了客户端和源服务器判断是否存在代理的问题，追加的是代理主机名（或者域名）<br></p> <p><img src="https://static001.geekbang.org/resource/image/52/d7/52a3bd760584972011f6be1a5258e2d7.png" alt="image"></p> <p><strong>如果想要知道客户端的真实 IP 地址，可以使用字段“X-Forwarded-For”和“X-Real-IP”；</strong><br></p> <p>2.“X-Forwarded-For”的字面意思是“为谁而转发”，形式上和“Via”差不多，追加的是请求方的 IP 地址。<br></p> <p>3.“X-Real-IP”是另一种获取客户端真实 IP 的手段，它的作用很简单，就是记录客户端 IP 地址，没有中间的代理信息，相当于是“X-Forwarded-For”的简化版。如果客户端和源服务器之间只有一个代理，那么这两个字段的值就是相同的。<br></p> <h4 id="代理协议"><a href="#代理协议" class="header-anchor">#</a> 代理协议</h4> <p><strong>“代理协议”可以在不改动原始报文的情况下传递客户端的真实 IP。</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">PROXY</span> <span class="token constant">TCP4</span> <span class="token number">1.1</span><span class="token number">.1</span><span class="token number">.1</span> <span class="token number">2.2</span><span class="token number">.2</span><span class="token number">.2</span> <span class="token number">55555</span> <span class="token number">80</span>\r\n
<span class="token constant">GET</span> <span class="token operator">/</span> <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>\r\n
<span class="token literal-property property">Host</span><span class="token operator">:</span> www<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>com\r\n
\r\n
</code></pre></div><p>第一行文本就是代理协议，这一行文本其实非常简单，开头必须是“PROXY”五个大写字母，然后是“TCP4”或者“TCP6”，表示客户端的 IP 地址类型，再后面是请求方地址、应答方地址、请求方端口号、应答方端口号，最后用一个回车换行（\r\n）结束。</p> <h3 id="http的缓存代理"><a href="#http的缓存代理" class="header-anchor">#</a> HTTP的缓存代理</h3> <p><strong>缓存代理服务</strong></p> <p><img src="https://static001.geekbang.org/resource/image/5e/c2/5e8d10b5758685850aeed2a473a6cdc2.png" alt="image"></p> <p>代理服务收到源服务器发来的响应数据后需要做两件事。第一个当然是把报文转发给客户端，而第二个就是把报文存入自己的 Cache 里。下一次再有相同的请求，代理服务器就可以直接发送 304 或者缓存数据，不必再从源服务器那里获取。这样就降低了客户端的等待时间，同时节约了源服务器的网络带宽。<br></p> <p><strong>源服务器的缓存控制</strong></p> <p><img src="https://static001.geekbang.org/resource/image/09/35/09266657fa61d0d1a720ae3360fe9535.png" alt="image"></p> <p>src:<br>
1.“private”表示缓存只能在客户端保存，是用户“私有”的，不能放在代理上与别人共享。<br>
2.而“public”的意思就是缓存完全开放，谁都可以存，谁都可以用。<br>
3.“must-revalidate”是只要过期就必须回源服务器验证，<br>
4.而新的“proxy-revalidate”只要求代理的缓存过期后必须验证，客户端不必回源，只验证到代理这个环节就行了。<br>
5.服务器用“s-maxage”,客户端仍然使用“max-age”。<br></p> <p><strong>客户端的缓存控制</strong></p> <p><img src="https://static001.geekbang.org/resource/image/47/92/47c1a69c800439e478c7a4ed40b8b992.png" alt="image"></p> <p>src:<br>
1.max-stale”的意思是如果代理上的缓存过期了也可以接受，但不能过期太多，超过 x 秒也会不要。<br>
2.“min-fresh”的意思是缓存必须有效，而且必须在 x 秒后依然有效。<br></p> <p><strong>其他问题</strong>
Purge:<br>
1.过期的数据应该及时淘汰，避免占用空间；<br>
2.源站的资源有更新，需要删除旧版本，主动换成最新版（即刷新）；<br>
3.有时候会缓存了一些本不该存储的信息，例如网络谣言或者危险链接，必须尽快把它们删除。<br></p> <h2 id="http面试题"><a href="#http面试题" class="header-anchor">#</a> HTTP面试题</h2> <h3 id="在csdn上写的http总结"><a href="#在csdn上写的http总结" class="header-anchor">#</a> 在CSDN上写的HTTP总结</h3> <div class="custom-block tip"><p class="title"></p><p><a href="https://blog.csdn.net/weixin_60789461/article/details/120473226?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">HTTP面试题总结<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div><h3 id="http是什么"><a href="#http是什么" class="header-anchor">#</a> HTTP是什么？</h3> <p>答：<br>
HTTP(Hyper Text Transfer Protocol)，是超文本传输协议。<br>
这个名词可以划分为三个部分--“超文本”,“传输”,“协议”<br>
首先看协议，协议是你与我之间，我与他之间的一个约定和规范<br>
传输则需要两个对象，分别是请求方和响应方，数据在这两者之间传输，但应该注意的是，请求方和响应方中间也有可能存在中间人，也就是代理，可以有一个中间人，也可以有无穷多个中间人。<br>
那超文本是什么呢？<br>
不妨先看看文本是什么。文本，顾名思义，就是有意义的文字，音频，视频。<br>
那超越文本的超文本是什么呢？<br>
超文本就是超越了这些文本的文本，是文字，音频，视频的集合体，同时其中存在着超链接，可以从一个文本跳转到另一个文本。<br>
所以，HTTP是一个用在计算机世界里的协议，它确立了一种计算机之间交流通信的规范，以及相关的各种控制和错误处理方式。</p> <h3 id="cookie和cache的异同"><a href="#cookie和cache的异同" class="header-anchor">#</a> Cookie和Cache的异同</h3> <p>(1)相同点：<br>
都会保存到浏览器中，并可以设置过期时间。<br>
(2)不同点：<br></p> <ol><li>Cookie 会随请求报文发送到服务器，而 Cache 不会，但可能会携带 if-Modified-Since（保存资源的最后修改时间）和 If-None-Match（保存资源唯一标识） 字段来验证资源是否过期。<br></li> <li>Cookie 在浏览器可以通过脚本获取（如果 cookie 没有设置 HttpOnly），Cache 则无法在浏览器中获取（出于安全原因）。<br></li> <li>用途不同。Cookie 常用于身份识别，Cache 则是由浏览器管理，用于节省带宽和加快响应速度。<br></li> <li>Cookie 的 max-age 是从浏览器拿到响应报文时开始计算的，而 Cache 的 max-age 是从响应报文的生成时间（Date 头字段）开始计算。<br></li></ol> <h3 id="https是什么-ssl-tls又是什么"><a href="#https是什么-ssl-tls又是什么" class="header-anchor">#</a> HTTPS是什么？SSL/TLS又是什么</h3> <h4 id="什么是安全"><a href="#什么是安全" class="header-anchor">#</a> 什么是安全？</h4> <p>安全有四个特性：<br>
(1)机密性：<br>
机密性（Secrecy/Confidentiality）是指对数据的“保密”，只能由可信的人访问，对其他人是不可见的“秘密”，简单来说就是不能让不相关的人看到不该看的东西。<br>
(2)完整性：<br>
完整性（Integrity，也叫一致性）是指数据在传输过程中没有被篡改，不多也不少，“完完整整”地保持着原状。<br>
(3)身份验证：<br>
身份认证（Authentication）是指确认对方的真实身份，也就是“证明你真的是你”，保证消息只能发送给可信的人。<br>
(4)不可否认：<br>
不可否认（Non-repudiation/Undeniable），也叫不可抵赖，意思是不能否认已经发生过的行为，不能“说话不算数”“耍赖皮”。<br></p> <h4 id="什么是-https"><a href="#什么是-https" class="header-anchor">#</a> 什么是 HTTPS？</h4> <p>HTTP是：<br> <code>“HTTP over TCP/IP”</code><br>
HTTPS是：<br> <code>“HTTP over SSL/TLS”</code><br></p> <p><img src="https://static001.geekbang.org/resource/image/50/a3/50d57e18813e18270747806d5d73f0a3.png" alt="image"></p> <h4 id="什么是ssl-tls"><a href="#什么是ssl-tls" class="header-anchor">#</a> 什么是SSL/TLS</h4> <p>1.SSL 即安全套接层（Secure Sockets Layer）<br></p> <p>2.SSL 发展到 v3 时已经证明了它自身是一个非常好的安全通信协议，于是互联网工程组 IETF 在 1999 年把它改名为 TLS（传输层安全，Transport Layer Security），正式标准化，版本号从 1.0 重新算起，所以 TLS1.0 实际上就是 SSLv3.1。<br></p></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/learn-javas/handbook/blog.html" class="prev">
            Connections
          </a></span> <span class="next"><a href="/learn-javas/handbook/http.html" aria-current="page" class="router-link-exact-active router-link-active">
            其他网络协议相关
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http知识点总结" class="sidebar-link reco-side-http知识点总结" data-v-cb1513f6>HTTP知识点总结</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http的报文是什么样子的" class="sidebar-link reco-side-http的报文是什么样子的" data-v-cb1513f6>HTTP的报文是什么样子的</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#常用头字段" class="sidebar-link reco-side-常用头字段" data-v-cb1513f6>常用头字段</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#应该如何理解请求方法" class="sidebar-link reco-side-应该如何理解请求方法" data-v-cb1513f6>应该如何理解请求方法</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#uri相关知识" class="sidebar-link reco-side-uri相关知识" data-v-cb1513f6>URI相关知识</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#状态码相关知识" class="sidebar-link reco-side-状态码相关知识" data-v-cb1513f6>状态码相关知识</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http有哪些特点" class="sidebar-link reco-side-http有哪些特点" data-v-cb1513f6>HTTP有哪些特点</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http的优点与缺点" class="sidebar-link reco-side-http的优点与缺点" data-v-cb1513f6>HTTP的优点与缺点</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http的实体数据「body」" class="sidebar-link reco-side-http的实体数据「body」" data-v-cb1513f6>HTTP的实体数据「body」</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http的大文件传输方法" class="sidebar-link reco-side-http的大文件传输方法" data-v-cb1513f6>HTTP的大文件传输方法</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http的连接管理" class="sidebar-link reco-side-http的连接管理" data-v-cb1513f6>HTTP的连接管理</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http中的重定向" class="sidebar-link reco-side-http中的重定向" data-v-cb1513f6>HTTP中的重定向</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http中的cookie机制" class="sidebar-link reco-side-http中的cookie机制" data-v-cb1513f6>HTTP中的Cookie机制</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http的代理服务" class="sidebar-link reco-side-http的代理服务" data-v-cb1513f6>HTTP的代理服务</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http的缓存代理" class="sidebar-link reco-side-http的缓存代理" data-v-cb1513f6>HTTP的缓存代理</a></li><li class="level-2" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http面试题" class="sidebar-link reco-side-http面试题" data-v-cb1513f6>HTTP面试题</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#在csdn上写的http总结" class="sidebar-link reco-side-在csdn上写的http总结" data-v-cb1513f6>在CSDN上写的HTTP总结</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#http是什么" class="sidebar-link reco-side-http是什么" data-v-cb1513f6>HTTP是什么？</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#cookie和cache的异同" class="sidebar-link reco-side-cookie和cache的异同" data-v-cb1513f6>Cookie和Cache的异同</a></li><li class="level-3" data-v-cb1513f6><a href="/learn-javas/handbook/http.html#https是什么-ssl-tls又是什么" class="sidebar-link reco-side-https是什么-ssl-tls又是什么" data-v-cb1513f6>HTTPS是什么？SSL/TLS又是什么</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎来到 前端知识库@阳树阳树🚀
    </div> <div class="operation" style="right:90px;bottom:40px;display:none;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/learn-javas/assets/js/app.1d4069ff.js" defer></script><script src="/learn-javas/assets/js/3.ca18a2f9.js" defer></script><script src="/learn-javas/assets/js/1.5581c46e.js" defer></script><script src="/learn-javas/assets/js/23.fea367bc.js" defer></script>
  </body>
</html>
